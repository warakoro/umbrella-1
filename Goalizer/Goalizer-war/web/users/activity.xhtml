<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">
    <ui:composition template="../default/main.xhtml">
        <ui:define name="content">
            <h:body>
                <h:form id="form">
                <div class="row centered-form">
                    <div class="col-xs-12 col-sm-8 col-md-4 col-sm-offset-2 col-md-offset-4">
                        <div class="panel panel-default">
                            <div class="panel-heading"><h3 class="panel-title text-center">Add Activity for activityMB.task.title</h3></div>
                            <div class="panel-body" align="center">
                                <h:panelGrid id="singleTaskActivity" rendered="#{activityMB.single}" columns="3"> 
                                    ${activityMB.task.title} is done?&nbsp;&nbsp;
                                    <h:commandButton value="Done!" action="#{activityMB.add()}" class="btn btn-success">
                                            <f:ajax execute="form" render="@all" />
                                    </h:commandButton>
                                    <h:button value="Back" outcome="task.html?id=#{activityMB.task.goalid.id}" class="btn btn-info"/>
                                </h:panelGrid>
                                <h:panelGrid id="recurringTaskActivity" rendered="#{not activityMB.single}" columns="3"> 
                                    Did ${activityMB.task.title}?&nbsp;&nbsp;  
                                    <h:commandButton value="1 out of ${activityMB.task.recurrence} times" action="#{activityMB.add()}" class="btn btn-primary">
                                            <f:ajax execute="form" render="@all" />
                                    </h:commandButton>
                                    <h:button value="Back" outcome="task.html?id=#{activityMB.task.goalid.id}" class="btn btn-info"/>
                                </h:panelGrid>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="container">
                    <table id="example" class="table table-striped table-bordered" cellspacing="0" width="100%">
                        <h:dataTable id="aTable" value="#{activityMB.activities}" var="activity" class="table table-striped">  
                        <h:column>
                            <f:facet name="header">
                                <h:outputText value="Activity Name"/>
                            </f:facet>
                            <h:inputText value="#{activity.name}" rendered="#{activity.editable}"/>
                            <h:outputText value="#{activity.name}" rendered="#{not activity.editable}"/>
                        </h:column>                          
                        <h:column>
                            <f:facet name="header">
                                <h:commandLink id="sortDateAsc" action="#{activityMB.sortByDate('ASC')}"><span class="glyphicon glyphicon-chevron-down"></span>
                                    <f:ajax render="form:aTable"/>
                                </h:commandLink>
                                Creation Date
                                <h:commandLink id="sortDeadlineDesc" action="#{activityMB.sortByDate('DESC')}"><span class="glyphicon glyphicon-chevron-up"></span>
                                    <f:ajax render="form:aTable"/>
                                </h:commandLink>
                            </f:facet>
                            <p:calendar value="#{activity.creationDate}" pattern="MM/dd/yyyy" rendered="#{activity.editable}"/>
                            <h:outputText value="#{activity.creationDate}" rendered="#{not activity.editable}"/>
                        </h:column>  
          
                        <h:column>
                            <h:commandLink action="#{activityMB.edit(activity)}" rendered="#{not activity.editable}" class="btn btn-link" style="color:rgb(0, 153, 0);"  >
                                <span class="glyphicon glyphicon-pencil">Edit</span>
                                <f:ajax render="form:aTable" />
                            </h:commandLink>
                            
                            <h:commandLink value="Save" action="#{activityMB.saveChanges(activity)}" rendered="#{activity.editable}" class="btn btn-link">
                                <f:ajax execute="form:aTable" render="form:aTable" />
                            </h:commandLink>
                        </h:column>
                        <h:column>
                            <h:commandLink value="Cancel" action="#{activityMB.cancelEdit(activity)}"  rendered="#{activity.editable}" class="btn btn-link">
                                <f:ajax render="form:aTable" />
                            </h:commandLink>
                        </h:column>
                        <h:column>
                            <h:commandLink id="remove" action="#{activityMB.remove(activity)}" style="color:rgb(209, 91, 71);"
                                           onclick="return confirm('Are you sure?')" class="btn btn-link"><span class="glyphicon glyphicon-trash">Delete</span>
                                <f:ajax render="form:aTable" />
                            </h:commandLink>
                        </h:column>
                    </h:dataTable>
                    </table>
                    </div>   
                </h:form>                
            </h:body>
        </ui:define>
    </ui:composition>
</html>

